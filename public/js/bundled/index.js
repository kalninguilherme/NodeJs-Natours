require("regenerator-runtime/runtime");var t=require("axios"),e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{};function r(t){return t&&t.__esModule?t.default:t}var n,o,a={},i=function(t){return t&&t.Math==Math&&t};a=i("object"==typeof globalThis&&globalThis)||i("object"==typeof window&&window)||i("object"==typeof self&&self)||i("object"==typeof e&&e)||function(){return this}()||a||Function("return this")();var u,c;u=!(c=function(t){try{return!!t()}catch(t){return!0}})((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}));var s,f={};s=!c((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")}));var p,l=Function.prototype.call;f=s?l.bind(l):function(){return l.apply(l,arguments)};var y={}.propertyIsEnumerable,d=Object.getOwnPropertyDescriptor,v=d&&!y.call({1:2},1);p=v?function(t){var e=d(this,t);return!!e&&e.enumerable}:y;var g;g=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}};var m,h,b={},w={},S=Function.prototype,E=S.call,O=s&&S.bind.bind(E,E),T=(w=s?O:function(t){return function(){return E.apply(t,arguments)}})({}.toString),A=w("".slice);h=function(t){return A(T(t),8,-1)};var j=Object,I=w("".split);b=c((function(){return!j("z").propertyIsEnumerable(0)}))?function(t){return"String"==h(t)?I(t,""):j(t)}:j;var _,P;P=function(t){return null==t};var M=TypeError;_=function(t){if(P(t))throw M("Can't call method on "+t);return t},m=function(t){return b(_(t))};var C,L,D,B={},R={},q="object"==typeof document&&document.all,x=(D={all:q,IS_HTMLDDA:void 0===q&&void 0!==q}).all;R=D.IS_HTMLDDA?function(t){return"function"==typeof t||t===x}:function(t){return"function"==typeof t};var F=D.all;B=D.IS_HTMLDDA?function(t){return"object"==typeof t?null!==t:R(t)||t===F}:function(t){return"object"==typeof t?null!==t:R(t)};var k,N={};k=function(t,e){return arguments.length<2?(r=a[t],R(r)?r:void 0):a[t]&&a[t][e];var r};var U={};U=w({}.isPrototypeOf);var Y,z,V,W={};W="undefined"!=typeof navigator&&String(navigator.userAgent)||"";var $,G,H=a.process,Z=a.Deno,J=H&&H.versions||Z&&Z.version,K=J&&J.v8;K&&(G=($=K.split("."))[0]>0&&$[0]<4?1:+($[0]+$[1])),!G&&W&&(!($=W.match(/Edge\/(\d+)/))||$[1]>=74)&&($=W.match(/Chrome\/(\d+)/))&&(G=+$[1]),V=G;var X=a.String;Y=(z=!!Object.getOwnPropertySymbols&&!c((function(){var t=Symbol();return!X(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&V&&V<41})))&&!Symbol.sham&&"symbol"==typeof Symbol.iterator;var Q=Object;N=Y?function(t){return"symbol"==typeof t}:function(t){var e=k("Symbol");return R(e)&&U(e.prototype,Q(t))};var tt,et,rt,nt=String;rt=function(t){try{return nt(t)}catch(t){return"Object"}};var ot=TypeError;et=function(t){if(R(t))return t;throw ot(rt(t)+" is not a function")},tt=function(t,e){var r=t[e];return P(r)?void 0:et(r)};var at,it=TypeError;at=function(t,e){var r,n;if("string"===e&&R(r=t.toString)&&!B(n=f(r,t)))return n;if(R(r=t.valueOf)&&!B(n=f(r,t)))return n;if("string"!==e&&R(r=t.toString)&&!B(n=f(r,t)))return n;throw it("Can't convert object to primitive value")};var ut,ct;var st,ft={},pt=Object.defineProperty;st=function(t,e){try{pt(a,t,{value:e,configurable:!0,writable:!0})}catch(r){a[t]=e}return e};var lt="__core-js_shared__",yt=a[lt]||st(lt,{});ft=yt,(ct=function(t,e){return ft[t]||(ft[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.31.1",mode:"global",copyright:"Â© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.31.1/LICENSE",source:"https://github.com/zloirock/core-js"});var dt,vt={},gt=Object;dt=function(t){return gt(_(t))};var mt=w({}.hasOwnProperty);vt=Object.hasOwn||function(t,e){return mt(dt(t),e)};var ht,bt=0,wt=Math.random(),St=w(1..toString);ht=function(t){return"Symbol("+(void 0===t?"":t)+")_"+St(++bt+wt,36)};var Et=a.Symbol,Ot=ct("wks"),Tt=Y?Et.for||Et:Et&&Et.withoutSetter||ht;ut=function(t){return vt(Ot,t)||(Ot[t]=z&&vt(Et,t)?Et[t]:Tt("Symbol."+t)),Ot[t]};var At=TypeError,jt=ut("toPrimitive");L=function(t,e){if(!B(t)||N(t))return t;var r,n=tt(t,jt);if(n){if(void 0===e&&(e="default"),r=f(n,t,e),!B(r)||N(r))return r;throw At("Can't convert object to primitive value")}return void 0===e&&(e="number"),at(t,e)},C=function(t){var e=L(t,"string");return N(e)?e:e+""};var It,_t,Pt=a.document,Mt=B(Pt)&&B(Pt.createElement);_t=function(t){return Mt?Pt.createElement(t):{}},It=!u&&!c((function(){return 7!=Object.defineProperty(_t("div"),"a",{get:function(){return 7}}).a}));var Ct,Lt,Dt=Object.getOwnPropertyDescriptor,Bt=o=u?Dt:function(t,e){if(t=m(t),e=C(e),It)try{return Dt(t,e)}catch(t){}if(vt(t,e))return g(!f(p,t,e),t[e])},Rt={};Lt=u&&c((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}));var qt,xt=String,Ft=TypeError;qt=function(t){if(B(t))return t;throw Ft(xt(t)+" is not an object")};var kt=TypeError,Nt=Object.defineProperty,Ut=Object.getOwnPropertyDescriptor,Yt="enumerable",zt="configurable",Vt="writable";Ct=u?Lt?function(t,e,r){if(qt(t),e=C(e),qt(r),"function"==typeof t&&"prototype"===e&&"value"in r&&Vt in r&&!r[Vt]){var n=Ut(t,e);n&&n[Vt]&&(t[e]=r.value,r={configurable:zt in r?r[zt]:n[zt],enumerable:Yt in r?r[Yt]:n[Yt],writable:!1})}return Nt(t,e,r)}:Nt:function(t,e,r){if(qt(t),e=C(e),qt(r),It)try{return Nt(t,e,r)}catch(t){}if("get"in r||"set"in r)throw kt("Accessors not supported");return"value"in r&&(t[e]=r.value),t},Rt=u?function(t,e,r){return Ct(t,e,g(1,r))}:function(t,e,r){return t[e]=r,t};var Wt,$t,Gt=Function.prototype,Ht=u&&Object.getOwnPropertyDescriptor,Zt=vt(Gt,"name"),Jt={EXISTS:Zt,PROPER:Zt&&"something"===function(){}.name,CONFIGURABLE:Zt&&(!u||u&&Ht(Gt,"name").configurable)}.CONFIGURABLE,Kt={},Xt=w(Function.toString);R(ft.inspectSource)||(ft.inspectSource=function(t){return Xt(t)}),Kt=ft.inspectSource;var Qt,te,ee=a.WeakMap;te=R(ee)&&/native code/.test(String(ee));var re,ne=ct("keys");re=function(t){return ne[t]||(ne[t]=ht(t))};var oe={};oe={};var ae,ie,ue,ce="Object already initialized",se=a.TypeError,fe=a.WeakMap;if(te||ft.state){var pe=ft.state||(ft.state=new fe);pe.get=pe.get,pe.has=pe.has,pe.set=pe.set,ae=function(t,e){if(pe.has(t))throw se(ce);return e.facade=t,pe.set(t,e),e},ie=function(t){return pe.get(t)||{}},ue=function(t){return pe.has(t)}}else{var le=re("state");oe[le]=!0,ae=function(t,e){if(vt(t,le))throw se(ce);return e.facade=t,Rt(t,le,e),e},ie=function(t){return vt(t,le)?t[le]:{}},ue=function(t){return vt(t,le)}}var ye=(Qt={set:ae,get:ie,has:ue,enforce:function(t){return ue(t)?ie(t):ae(t,{})},getterFor:function(t){return function(e){var r;if(!B(e)||(r=ie(e)).type!==t)throw se("Incompatible receiver, "+t+" required");return r}}}).enforce,de=Qt.get,ve=String,ge=Object.defineProperty,me=w("".slice),he=w("".replace),be=w([].join),we=u&&!c((function(){return 8!==ge((function(){}),"length",{value:8}).length})),Se=String(String).split("String"),Ee=$t=function(t,e,r){"Symbol("===me(ve(e),0,7)&&(e="["+he(ve(e),/^Symbol\(([^)]*)\)/,"$1")+"]"),r&&r.getter&&(e="get "+e),r&&r.setter&&(e="set "+e),(!vt(t,"name")||Jt&&t.name!==e)&&(u?ge(t,"name",{value:e,configurable:!0}):t.name=e),we&&r&&vt(r,"arity")&&t.length!==r.arity&&ge(t,"length",{value:r.arity});try{r&&vt(r,"constructor")&&r.constructor?u&&ge(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(t){}var n=ye(t);return vt(n,"source")||(n.source=be(Se,"string"==typeof e?e:"")),t};Function.prototype.toString=Ee((function(){return R(this)&&de(this).source||Kt(this)}),"toString"),Wt=function(t,e,r,n){n||(n={});var o=n.enumerable,a=void 0!==n.name?n.name:e;if(R(r)&&$t(r,a,n),n.global)o?t[e]=r:st(e,r);else{try{n.unsafe?t[e]&&(o=!0):delete t[e]}catch(t){}o?t[e]=r:Ct(t,e,{value:r,enumerable:!1,configurable:!n.nonConfigurable,writable:!n.nonWritable})}return t};var Oe,Te,Ae,je,Ie,_e={},Pe={},Me=Math.ceil,Ce=Math.floor;Pe=Math.trunc||function(t){var e=+t;return(e>0?Ce:Me)(e)},Ie=function(t){var e=+t;return e!=e||0===e?0:Pe(e)};var Le=Math.max,De=Math.min;je=function(t,e){var r=Ie(t);return r<0?Le(r+e,0):De(r,e)};var Be,Re,qe=Math.min;Re=function(t){return t>0?qe(Ie(t),9007199254740991):0},Be=function(t){return Re(t.length)};var xe=function(t){return function(e,r,n){var o,a=m(e),i=Be(a),u=je(n,i);if(t&&r!=r){for(;i>u;)if((o=a[u++])!=o)return!0}else for(;i>u;u++)if((t||u in a)&&a[u]===r)return t||u||0;return!t&&-1}},Fe={includes:xe(!0),indexOf:xe(!1)}.indexOf,ke=w([].push);Ae=function(t,e){var r,n=m(t),o=0,a=[];for(r in n)!vt(oe,r)&&vt(n,r)&&ke(a,r);for(;e.length>o;)vt(n,r=e[o++])&&(~Fe(a,r)||ke(a,r));return a};var Ne,Ue=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"].concat("length","prototype");Te=Object.getOwnPropertyNames||function(t){return Ae(t,Ue)},Ne=Object.getOwnPropertySymbols;var Ye=w([].concat);_e=k("Reflect","ownKeys")||function(t){var e=Te(qt(t));return Ne?Ye(e,Ne(t)):e},Oe=function(t,e,r){for(var n=_e(e),a=Ct,i=o,u=0;u<n.length;u++){var c=n[u];vt(t,c)||r&&vt(r,c)||a(t,c,i(e,c))}};var ze={},Ve=/#|\.prototype\./,We=function(t,e){var r=Ge[$e(t)];return r==Ze||r!=He&&(R(e)?c(e):!!e)},$e=We.normalize=function(t){return String(t).replace(Ve,".").toLowerCase()},Ge=We.data={},He=We.NATIVE="N",Ze=We.POLYFILL="P";ze=We,n=function(t,e){var r,n,o,i,u,c=t.target,s=t.global,f=t.stat;if(r=s?a:f?a[c]||st(c,{}):(a[c]||{}).prototype)for(n in e){if(i=e[n],o=t.dontCallGetSet?(u=Bt(r,n))&&u.value:r[n],!ze(s?n:c+(f?".":"#")+n,t.forced)&&void 0!==o){if(typeof i==typeof o)continue;Oe(i,o)}(t.sham||o&&o.sham)&&Rt(i,"sham",!0),Wt(r,n,i,t)}};var Je=Math.hypot,Ke=Math.abs,Xe=Math.sqrt;n({target:"Math",stat:!0,arity:2,forced:!!Je&&Je(1/0,NaN)!==1/0},{hypot:function(t,e){for(var r,n,o=0,a=0,i=arguments.length,u=0;a<i;)u<(r=Ke(arguments[a++]))?(o=o*(n=u/r)*n+1,u=r):o+=r>0?(n=r/u)*n:r;return u===1/0?1/0:u*Xe(o)}});var Qe,tr;tr="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView;var er,rr={},nr={};nr[ut("toStringTag")]="z",er="[object z]"===String(nr);var or=ut("toStringTag"),ar=Object,ir="Arguments"==h(function(){return arguments}());rr=er?h:function(t){var e,r,n;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(r=function(t,e){try{return t[e]}catch(t){}}(e=ar(t),or))?r:ir?h(e):"Object"==(n=h(e))&&R(e.callee)?"Arguments":n};var ur;ur=function(t,e,r){return r.get&&$t(r.get,e,{getter:!0}),r.set&&$t(r.set,e,{setter:!0}),Ct(t,e,r)};var cr,sr={};cr=!c((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}));var fr=re("IE_PROTO"),pr=Object,lr=pr.prototype;sr=cr?pr.getPrototypeOf:function(t){var e=dt(t);if(vt(e,fr))return e[fr];var r=e.constructor;return R(r)&&e instanceof r?r.prototype:e instanceof pr?lr:null};var yr,dr={};yr=function(t,e,r){try{return w(et(Object.getOwnPropertyDescriptor(t,e)[r]))}catch(t){}};var vr,gr=String,mr=TypeError;vr=function(t){if("object"==typeof t||R(t))return t;throw mr("Can't set "+gr(t)+" as a prototype")},dr=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,r={};try{(t=yr(Object.prototype,"__proto__","set"))(r,[]),e=r instanceof Array}catch(t){}return function(r,n){return qt(r),vr(n),e?t(r,n):r.__proto__=n,r}}():void 0);var hr,br,wr,Sr=Qt.enforce,Er=Qt.get,Or=a.Int8Array,Tr=Or&&Or.prototype,Ar=a.Uint8ClampedArray,jr=Ar&&Ar.prototype,Ir=Or&&sr(Or),_r=Tr&&sr(Tr),Pr=Object.prototype,Mr=a.TypeError,Cr=ut("toStringTag"),Lr=ht("TYPED_ARRAY_TAG"),Dr="TypedArrayConstructor",Br=tr&&!!dr&&"Opera"!==rr(a.opera),Rr=!1,qr={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},xr={BigInt64Array:8,BigUint64Array:8},Fr=function(t){var e=sr(t);if(B(e)){var r=Er(e);return r&&vt(r,Dr)?r[Dr]:Fr(e)}},kr=function(t){if(!B(t))return!1;var e=rr(t);return vt(qr,e)||vt(xr,e)};for(hr in qr)(wr=(br=a[hr])&&br.prototype)?Sr(wr)[Dr]=br:Br=!1;for(hr in xr)(wr=(br=a[hr])&&br.prototype)&&(Sr(wr)[Dr]=br);if((!Br||!R(Ir)||Ir===Function.prototype)&&(Ir=function(){throw Mr("Incorrect invocation")},Br))for(hr in qr)a[hr]&&dr(a[hr],Ir);if((!Br||!_r||_r===Pr)&&(_r=Ir.prototype,Br))for(hr in qr)a[hr]&&dr(a[hr].prototype,_r);if(Br&&sr(jr)!==_r&&dr(jr,_r),u&&!vt(_r,Cr))for(hr in Rr=!0,ur(_r,Cr,{configurable:!0,get:function(){return B(this)?this[Lr]:void 0}}),qr)a[hr]&&Rt(a[hr],Lr,hr);Qe={NATIVE_ARRAY_BUFFER_VIEWS:Br,TYPED_ARRAY_TAG:Rr&&Lr,aTypedArray:function(t){if(kr(t))return t;throw Mr("Target is not a typed array")},aTypedArrayConstructor:function(t){if(R(t)&&(!dr||U(Ir,t)))return t;throw Mr(rt(t)+" is not a typed array constructor")},exportTypedArrayMethod:function(t,e,r,n){if(u){if(r)for(var o in qr){var i=a[o];if(i&&vt(i.prototype,t))try{delete i.prototype[t]}catch(r){try{i.prototype[t]=e}catch(t){}}}_r[t]&&!r||Wt(_r,t,r?e:Br&&Tr[t]||e,n)}},exportTypedArrayStaticMethod:function(t,e,r){var n,o;if(u){if(dr){if(r)for(n in qr)if((o=a[n])&&vt(o,t))try{delete o[t]}catch(t){}if(Ir[t]&&!r)return;try{return Wt(Ir,t,r?e:Br&&Ir[t]||e)}catch(t){}}for(n in qr)!(o=a[n])||o[t]&&!r||Wt(o,t,e)}},getTypedArrayConstructor:Fr,isView:function(t){if(!B(t))return!1;var e=rr(t);return"DataView"===e||vt(qr,e)||vt(xr,e)},isTypedArray:kr,TypedArray:Ir,TypedArrayPrototype:_r};var Nr,Ur,Yr=RangeError;Ur=function(t){var e=Ie(t);if(e<0)throw Yr("The argument can't be less than 0");return e};var zr=RangeError;Nr=function(t,e){var r=Ur(t);if(r%e)throw zr("Wrong offset");return r};var Vr=a.RangeError,Wr=a.Int8Array,$r=Wr&&Wr.prototype,Gr=$r&&$r.set,Hr=Qe.aTypedArray,Zr=Qe.exportTypedArrayMethod,Jr=!c((function(){var t=new Uint8ClampedArray(2);return f(Gr,t,{length:1,0:3},1),3!==t[1]})),Kr=Jr&&Qe.NATIVE_ARRAY_BUFFER_VIEWS&&c((function(){var t=new Wr(2);return t.set(1),t.set("2",1),0!==t[0]||2!==t[1]}));Zr("set",(function(t){Hr(this);var e=Nr(arguments.length>1?arguments[1]:void 0,1),r=dt(t);if(Jr)return f(Gr,this,r,e);var n=this.length,o=Be(r),a=0;if(o+e>n)throw Vr("Wrong length");for(;a<o;)this[e+a]=r[a++]}),!Jr||Kr);const Xr=t=>{mapboxgl.accessToken="pk.eyJ1Ijoiam9uYXNzY2htZWR0bWFubiIsImEiOiJjam54ZmM5N3gwNjAzM3dtZDNxYTVlMnd2In0.ytpI7V7w7cyT1Kq5rT9Z1A";var e=new mapboxgl.Map({container:"map",style:"mapbox://styles/jonasschmedtmann/cjvi9q8jd04mi1cpgmg7ev3dy",scrollZoom:!1});const r=new mapboxgl.LngLatBounds;t.forEach((t=>{const n=document.createElement("div");n.className="marker",new mapboxgl.Marker({element:n,anchor:"bottom"}).setLngLat(t.coordinates).addTo(e),new mapboxgl.Popup({offset:30}).setLngLat(t.coordinates).setHTML(`<p>Day ${t.day}: ${t.description}</p>`).addTo(e),r.extend(t.coordinates)})),e.fitBounds(r,{padding:{top:200,bottom:150,left:100,right:100}})},Qr=()=>{const t=document.querySelector(".alert");t&&t.parentElement.removeChild(t)},tn=(t,e)=>{Qr();const r=`<div class="alert alert--${t}">${e}</div>`;document.querySelector("body").insertAdjacentHTML("afterbegin",r),window.setTimeout(Qr,5e3)},en=async(e,n)=>{try{"success"===(await r(t)({method:"POST",url:"/api/v1/users/login",data:{email:e,password:n}})).data.status&&(tn("success","Logged in successfully!"),window.setTimeout((()=>{location.assign("/")}),2e3))}catch(t){tn("error",t.response.data.message)}},rn=async(e,n)=>{try{const o="password"===n?"/api/v1/users/updateMyPassword":"/api/v1/users/updateMe",a=await r(t)({method:"PATCH",url:o,data:e});if("success"===a.data.status&&(tn("success",`${n.toUpperCase()} updated successfully!`),"photo"===n))return a.data.data.user.photo}catch(t){tn("error",t.response.data.message)}},nn=Stripe(process.env.STRIPE_SECRET_KEY),on=async e=>{try{const n=await r(t)(`/api/v1/bookings/checkout-session/${e}`);await nn.redirectToCheckout({sessionId:n.data.session.id})}catch(t){console.log(t),tn("error",t)}},an=document.getElementById("map"),un=document.querySelector(".form--login"),cn=document.querySelector(".nav__el--logout"),sn=document.querySelector(".form-user-data"),fn=document.querySelector(".form__upload"),pn=document.querySelector(".form-user-password"),ln=document.getElementById("book-tour");if(an){Xr(JSON.parse(an.dataset.locations))}un&&un.addEventListener("submit",(t=>{t.preventDefault();const e=document.getElementById("email").value,r=document.getElementById("password").value;en(e,r)})),cn&&cn.addEventListener("click",(async()=>{try{"success"===(await r(t)({method:"GET",url:"/api/v1/users/logout"})).data.status&&window.setTimeout((()=>{location.assign("/")}),1e3)}catch(t){console.log(t.response),tn("error","Error logging out! Try again.")}})),sn&&sn.addEventListener("submit",(async t=>{t.preventDefault(),document.querySelector(".btn--save-settings").textContent="Updating...";const e=new FormData;e.append("name",document.getElementById("name").value),e.append("email",document.getElementById("email").value),await rn(e,"data"),document.querySelector(".btn--save-settings").textContent="Save settings"})),fn&&fn.addEventListener("change",(async t=>{t.preventDefault();const e=new FormData;e.append("photo",document.getElementById("photo").files[0]);const r=await rn(e,"photo");r&&(document.querySelector(".nav__user-img").setAttribute("src",`/img/users/${r}`),document.querySelector(".form__user-photo").setAttribute("src",`/img/users/${r}`))})),pn&&pn.addEventListener("submit",(async t=>{t.preventDefault(),document.querySelector(".btn--save-password").textContent="Updating...";const e=document.getElementById("password-current").value,r=document.getElementById("password").value,n=document.getElementById("password-confirm").value;await rn({passwordCurrent:e,password:r,passwordConfirm:n},"password"),document.querySelector(".btn--save-password").textContent="Save password",document.getElementById("password-current").value="",document.getElementById("password").value="",document.getElementById("password-confirm").value=""})),ln&&ln.addEventListener("click",(t=>{t.target.textContent="Processing...";const{tourId:e}=t.target.dataset;on(e)}));const yn=document.querySelector("body").dataset.alert;yn&&tn("success",yn);
//# sourceMappingURL=index.js.map
